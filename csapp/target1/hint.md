## Hint for Phase 5

阶段五的难点在于需要获取到 cookie 字符串的地址，虽然可以通过 `movq %rsp, %rax` 获取到当前栈指针的值，但因为需要保持程序运行，所以这个值一般不能是字符串的地址。

但是 writeup 中只有数据转移指令，没有加法之类的数据操作指令，一开始我是想找到一个 gadget 先获取地址再用 `popq` 指令转移控制，但是找了很久并没有找到这样的 gadget，最后看了[【读厚 CSAPP】III Attack Lab](https://wdxtub.com/csapp/thick-csapp-lab-3/2016/04/16/)，才注意到给出的 gadget farm 中有一个 `add_xy()` 的函数，有了这个攻击就简单了，只需要想办法将获取的栈指针的值加上一个特定值，结果就是最终存放字符串的地址，复制到 `%rdi` 后再调用 `touch3()` 即可。

其实阶段五和阶段四的难度相当，主要是想到可以直接利用给出的函数，而非总是想着利用典型的“ROP”代码。